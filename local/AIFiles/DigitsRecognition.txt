# Create the <strong>datasets</strong> directory.
import os
datasets_dir = './datasets'
if not os.path.exists(datasets_dir):
    os.makedirs(datasets_dir)
    
# URL of the MNIST dataset zip file
mnist_url = 'https://labfiles-singapore.obs.ap-southeast-3.myhuaweicloud.com/modelarts/MNIST_data.zip'
zip_file_path = os.path.join(datasets_dir, 'MNIST_data.zip')
# Download the MNIST_data.zip file using wget
!wget {mnist_url} -O {zip_file_path}
# Unzip the downloaded file into the datasets directory
!unzip {zip_file_path} -d {datasets_dir}

import os
import torchvision.datasets.mnist as mnist

# Read training samples.
train_data = mnist.read_image_file(os.path.join(datasets_dir, 'MNIST_data/raw/train-images-idx3-ubyte'))
train_label = mnist.read_label_file(os.path.join(datasets_dir, 'MNIST_data/raw/train-labels-idx1-ubyte'))
# Read test samples.
test_data = mnist.read_image_file(os.path.join(datasets_dir, 'MNIST_data/raw/t10k-images-idx3-ubyte'))
test_label = mnist.read_label_file(os.path.join(datasets_dir, 'MNIST_data/raw/t10k-labels-idx1-ubyte'))

print('training set scale:', train_data.shape, train_label.shape) # 60,000 training samples
print('training set scale:', test_data.shape, test_label.shape) # 10,000 training samples

from PIL import Image
img = train_data[1].numpy() # train_data[1] is in the tensor format. Convert it to the NumPy format.
print('image label:', train_label[1].item())
print ('image size :', img.shape)
Image.fromarray(img) # Convert the image to a format supported by PIL for display.

img = train_data[3].numpy() # train_data[3] is in the tensor format. Convert it to the NumPy format.
print('image label:', train_label[3].item())
print ('image size :', img.shape)
Image.fromarray(img) # Convert the image to a format supported by PIL for display.

